<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Inventario API</title>
    <script src="styles/theme-loader.js"></script>

    <style>
@keyframes fadein {
  from { opacity: 0; }
  to   { opacity: 1; }
}

body {
  /* Asigna la animación al body */
  animation: fadein 1s ease-in-out; 
  /* Asegura que el estado final (opacity: 1) se mantenga */
  animation-fill-mode: forwards; 
  /* Opcional: Esto asegura que el elemento empiece invisible antes de la animación */
  opacity: 0; 
}
    </style>
    <link rel="stylesheet" href="styles/index.css">
    <link rel="stylesheet" href="styles/styles.css">
</head>

<body>

    <div class="container">

        <button id="theme-toggle-btn" title="Cambiar a modo oscuro">
            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><g fill="currentColor" fill-opacity="0"><path d="M15.22 6.03l2.53 -1.94l-3.19 -0.09l-1.06 -3l-1.06 3l-3.19 0.09l2.53 1.94l-0.91 3.06l2.63 -1.81l2.63 1.81l-0.91 -3.06Z"><animate fill="freeze" attributeName="fill-opacity" begin="0.7s" dur="0.4s" values="0;1"/></path><path d="M19.61 12.25l1.64 -1.25l-2.06 -0.05l-0.69 -1.95l-0.69 1.95l-2.06 0.05l1.64 1.25l-0.59 1.98l1.7 -1.17l1.7 1.17l-0.59 -1.98Z"><animate fill="freeze" attributeName="fill-opacity" begin="1.1s" dur="0.4s" values="0;1"/></path></g><path fill="none" stroke="currentColor" stroke-dasharray="56" stroke-dashoffset="56" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 6c0 6.08 4.92 11 11 11c0.53 0 1.05 -0.04 1.56 -0.11c-1.61 2.47 -4.39 4.11 -7.56 4.11c-4.97 0 -9 -4.03 -9 -9c0 -3.17 1.64 -5.95 4.11 -7.56c-0.07 0.51 -0.11 1.03 -0.11 1.56Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.6s" values="56;0"/></path></svg>
        </button>

        <h1>
            <span class="icon-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24">
                    <path fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="1.5"
                        d="m12 12l8.073-4.625M12 12v9.25M12 12L7.963 9.688m12.11-2.313a3.17 3.17 0 0 0-1.165-1.156L16.25 4.696m3.823 2.679c.275.472.427 1.015.427 1.58v6.09a3.15 3.15 0 0 1-1.592 2.736l-5.316 3.046A3.2 3.2 0 0 1 12 21.25M3.926 7.375a3.14 3.14 0 0 0-.426 1.58v6.09c0 1.13.607 2.172 1.592 2.736l5.316 3.046A3.2 3.2 0 0 0 12 21.25M3.926 7.375a3.17 3.17 0 0 1 1.166-1.156l5.316-3.046a3.2 3.2 0 0 1 3.184 0l2.658 1.523M3.926 7.375l4.037 2.313m0 0l8.287-4.992" />
                </svg>
            </span>
            Termita by LUMO Group
        </h1>

        <div id="message"></div>

        <div class="form-section">
            <h2>
                <span class="icon-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21l-4.343-4.343m0 0A8 8 0 1 0 5.343 5.343a8 8 0 0 0 11.314 11.314"/></svg>
                </span>
                Consultar Inventario
            </h2>
            <div class="input-group" id="filterButtons">
                <select id="filterKey" title="Columna a filtrar">
                    <option value="">-- Seleccionar Columna --</option>
                </select>
                <input type="text" id="filterValue" placeholder="Valor del filtro (ej: Hogar)">
                <select id="matchMode">
                    <option value="exacta">Coincidencia Exacta</option>
                    <option value="mascercana">Coincidencia Parcial</option>
                    <option value="all">Coincidencia Múltiple (CSV)</option>
                </select>
                <button onclick="Termita.logic.fetchInventory()"><span>Buscar Productos</span></button>
                <button onclick="Termita.logic.fetchInventory(true)" id="secondaryBtn"><span>Mostrar Todo</span></button>
            </div>
        </div>

        <div class="form-section">
            <h2 id="addEditTitle">
                <span class="icon-title">
<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><g fill="none"><path stroke="currentColor" strokeLinecap="round" strokeLinejoin="round" strokeWidth="1.5" d="m11 12l8.073-4.625M11 12L6.963 9.688M11 12v2.281m8.073-6.906a3.17 3.17 0 0 0-1.165-1.156L15.25 4.696m3.823 2.679c.275.472.427 1.015.427 1.58v1.608M2.926 7.374a3.14 3.14 0 0 0-.426 1.58v6.09c0 1.13.607 2.172 1.592 2.736l5.316 3.046A3.2 3.2 0 0 0 11 21.25M2.926 7.375a3.17 3.17 0 0 1 1.166-1.156l5.316-3.046a3.2 3.2 0 0 1 3.184 0l2.658 1.523M2.926 7.375l4.037 2.313m0 0l8.287-4.992"/><path fill="currentColor" fillRule="evenodd" d="M17.5 23a5.5 5.5 0 1 0 0-11a5.5 5.5 0 0 0 0 11m0-8.993a.5.5 0 0 1 .5.5V17h2.493a.5.5 0 1 1 0 1H18v2.493a.5.5 0 1 1-1 0V18h-2.493a.5.5 0 1 1 0-1H17v-2.493a.5.5 0 0 1 .5-.5" clipRule="evenodd"/></g></svg>                Agregar Nuevo Producto
            </h2>
            <form id="productForm">
                <div class="input-group" id="productFieldsContainer">
                    <input type="text" id="sku" placeholder="SKU (Único)" required>
                    <input type="text" id="id" placeholder="ID (Opcional)">
                    <input type="text" id="nombre" placeholder="Nombre (Único)" required>
                    <input type="text" id="descripcion" placeholder="Descripción">
                </div>
                <div class="input-group">
                    <input type="number" id="cantidad" placeholder="Cantidad" min="0" value="1">
                    <input type="text" id="unidad" placeholder="Unidad (ej: Litro, Paquete)">
                    <input type="number" id="precio" placeholder="Precio" step="0.01" min="0" value="0.00" required>
                    <input type="text" id="categoria" placeholder="Categoría">
                </div>

                <div id="advancedOptionsContainer">
                    <button type="button" id="advancedToggleBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5"><path d="M8.73 21.499c1.293-2.223 4.252-2.485 5.937-.786c.377.38.566.57.733.592s1.215-.578 1.587-.792c.38-.217 1.432-.82 1.498-.979c.066-.157-.003-.427-.142-.965c-.503-1.957.718-4.017 2.668-4.548c.522-.142.783-.213.886-.349S22 12.341 22 11.904s0-1.633-.103-1.769s-.364-.207-.886-.349c-1.95-.531-3.172-2.59-2.67-4.548c.14-.538.208-.807.142-.965s-1.118-.761-1.497-.979c-.372-.213-1.42-.815-1.588-.792c-.167.023-.355.213-.732.592a3.775 3.775 0 0 1-5.333 0c-.377-.38-.566-.57-.733-.592s-1.215.579-1.587.792c-.38.218-1.432.821-1.498.979s.003.427.142.965c.503 1.957-.718 4.017-2.668 4.548c-.522.142-.783.213-.886.35C2 10.27 2 11.465 2 11.903s0 1.632.103 1.768s.364.207.886.35q.009 0 .018.004"/><path d="M2.489 18.183c1.08-1.08 4.752-4.714 5.112-5.134c.38-.444.072-1.044.256-2.903c.088-.9.282-1.573.836-2.075c.66-.624 1.2-.624 3.06-.666c1.62.042 1.812-.138 1.98.282c.12.3-.24.48-.672.96c-.96.96-1.524 1.44-1.578 1.74c-.39 1.319 1.146 2.098 1.986 1.258c.318-.317 1.788-1.799 1.932-1.919c.108-.096.366-.091.492.06c.108.106.12.12.108.6c-.011.444-.006 1.082-.005 1.74c.002.851-.043 1.799-.403 2.278c-.72 1.08-1.92 1.14-3 1.188c-1.02.06-1.86-.048-2.124.144c-.216.108-1.356 1.307-2.736 2.687l-2.46 2.459c-2.04 1.62-4.284-.9-2.784-2.7Z"/></g></svg>
                        Opciones Avanzadas
                    </button>
                </div>

                <div id="advancedFieldsContainer">
                    <h4>Campos Adicionales:</h4>
                </div>

                <input type="hidden" id="originalSku">
                <button type="submit" id="submitBtn"><span>Agregar Producto</span></button>
                <button type="button" id="cancelBtn" onclick="Termita.ui.resetForm()"><span>Cancelar Edición</span></button>
            </form>
        </div>

        <div class="inventory-list-container">
            <div class="inventory-header">
                <h2>
                    <span class="icon-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M16 4.002c2.175.012 3.353.109 4.121.877C21 5.758 21 7.172 21 10v6c0 2.829 0 4.243-.879 5.122C19.243 22 17.828 22 15 22H9c-2.828 0-4.243 0-5.121-.878C3 20.242 3 18.829 3 16v-6c0-2.828 0-4.242.879-5.121c.768-.768 1.946-.865 4.121-.877"/><path stroke-linecap="round" d="M10.5 14H17M7 14h.5M7 10.5h.5m-.5 7h.5m3-7H17m-6.5 7H17"/><path d="M8 3.5A1.5 1.5 0 0 1 9.5 2h5A1.5 1.5 0 0 1 16 3.5v1A1.5 1.5 0 0 1 14.5 6h-5A1.5 1.5 0 0 1 8 4.5z"/></g></svg>
                    </span>
                    Lista de Productos
                </h2>
            </div>

            <p id="no-results-message">Se requiere una búsqueda para poblar la tabla.</p>

            <div class="table-responsive">
                <table id="inventoryTable" class="modern-table">
                    <thead id="inventoryHeader">
                        <!-- El encabezado se generará dinámicamente con JavaScript -->
                    </thead>
                    <tbody id="inventoryBody">
                    </tbody>
                </table>
            </div>

            <div class="table-pagination">
                <button id="prevPageBtn" disabled><span>Previous</span></button>
                <button id="nextPageBtn" disabled><span>Next</span></button>
            </div>
        </div>
    </div>

    <!-- Scripts refactorizados en orden de dependencia -->
    <script src="app/api-client.js" defer></script>
    <script src="app/ui-manager.js" defer></script>
    <script src="app/app.js" defer></script>
</body>

</html>